#!/bin/bash -e
#
# pdfsplit [input.pdf] [first_page] [last_page] [output.pdf] 
#
# Example: pdfsplit big_file.pdf 10 20 pages_ten_to_twenty.pdf
#
# written by: Westley Weimer, Wed Mar 19 17:58:09 EDT 2008
#
# The trick: ghostscript (gs) will do PDF splitting for you, it's just not
# obvious and the required defines are not listed in the manual page. 

function echo_err() {
  echo -ne "${RED}"
  cat <<<"$@" 1>&2
  echo -ne "${NORMAL}"
}

if [ $# -lt 4 ] 
then
        echo "Usage: $(basename "$0") input.pdf first_page last_page output.pdf"
        exit 1
fi

command -v gs >/dev/null 2>&1
if [ $? -eq 1 ]; then
  echo_err "[WARNING] GS (GhostScript) not found in path. "
  exit 1
fi

gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -dALLOWPSTRANSPARENCY -dSAFER -dCompatibilityLevel="1.5" -dPDFSETTINGS="/printer"  -sOutputFile="$4" -dFirstPage=$2 -dLastPage=$3 -sDEVICE=pdfwrite "$1"
